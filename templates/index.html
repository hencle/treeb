<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>File picker</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jstree@3.3.15/dist/themes/default/style.min.css">
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jstree@3.3.15/dist/jstree.min.js"></script>

<style>
  body { font-family: system-ui, sans-serif; margin: 1.5rem; font-size: 14px; }
  #toolbar { 
    margin-bottom: 1rem; 
    padding-bottom: 0.75rem; 
    border-bottom: 1px solid #e0e0e0; 
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 8px;
  }
  #toolbar input[type="text"] { width: 25rem; padding: 6px; border: 1px solid #ccc; border-radius: 4px; }
  #toolbar select { padding: 6px; border: 1px solid #ccc; border-radius: 4px; margin-right: 5px;}
  #toolbar button { 
    padding: 6px 10px; border: 1px solid #ccc; border-radius: 4px; 
    background-color: #f0f0f0; cursor: pointer; margin-right: 5px;
  }
  #toolbar button:hover { background-color: #e0e0e0; }

  #main { display:flex; gap:2rem; align-items:flex-start; margin-top: 1rem;}
  #treeSection { flex:1 1 350px; min-width:280px; }
  #outputSection { flex:1 1 450px; display:flex; flex-direction:column; }
  
  #outputButtons { margin-bottom:.5rem; display: flex; align-items: center; gap: 8px; }
  #charCountDisplay { margin-left: 10px; font-size: 0.9em; color: #555; white-space: nowrap; }
  
  #result {
    flex: 1 1 auto; width: 100%; max-width: 100%; box-sizing: border-box;
    resize: vertical; min-height: 550px; padding: 8px;
    border: 1px solid #ccc; border-radius: 4px;
  }
  
  /* CSS for excluded items in jsTree */
  .jstree-anchor.excluded-item-style {
    opacity: 0.6;
    font-style: italic !important; 
  }
  /* Style for the checkbox of an excluded item when it's disabled by disable_checkbox() */
  .jstree-anchor.excluded-item-style > i.jstree-checkbox.jstree-checkbox-disabled {
    opacity: 0.4 !important; /* Further fade the checkbox background/border */
  }
  /* Force the icon part to look UNCHECKED for excluded items */
  .jstree-anchor.excluded-item-style > i.jstree-checkbox.jstree-checkbox-disabled::before,
  .jstree-anchor.excluded-item-style.jstree-clicked > i.jstree-checkbox::before, /* If parent cascade adds jstree-clicked to anchor */
  .jstree-anchor.excluded-item-style > i.jstree-checkbox.jstree-clicked::before { /* If cascade adds jstree-clicked to checkbox <i> */
    background-position: -4px -4px !important; /* Default theme UNCHECKED sprite (32px) */
                                             /* For 40px sprite: -5px -5px */
  }
   /* If the theme also changes classes on the <i> tag directly for checked state */
   .jstree-anchor.excluded-item-style > i.jstree-checkbox.jstree-checked.jstree-checkbox-disabled::before {
      background-position: -4px -4px !important; /* Still force UNCHECKED */
   }

  @media (max-width: 900px){
    #main { flex-direction:column; }
    #toolbar input[type="text"] { width: 100%; margin-bottom: 8px; }
    #toolbar { flex-direction: column; align-items: stretch; }
    #toolbar select, #toolbar button { width: 100%; margin-bottom: 8px; margin-right: 0; }
  }
</style>
</head>
<body>
  <div id="toolbar">
    <input id="rootPath" type="text" placeholder="Enter path and hit ‚ÄúLoad Path‚Äù" value="{{ initial_path }}">
    <button id="btnLoadPath">Load Path</button>
    <span>|</span>
    <select id="presetList"></select>
    <button id="btnLoadPreset">Load Sel.</button>
    <button id="btnDeletePreset" title="Delete selected selection preset">üóëÔ∏è Sel.</button>
    <button id="btnSavePreset" title="Save current selection as new preset">üíæ Sel. As‚Ä¶</button>
  </div>

  <div id="main">
    <div id="treeSection">
      <h2>Pick files</h2>
      <div id="tree">Loading tree...</div>
    </div>
    <div id="outputSection">
      <div id="outputButtons">
        <button id="btnGenerate">Generate TXT</button>
        <button id="btnCopy">Copy to clipboard</button>
        <span id="charCountDisplay"></span>
      </div>
      <textarea id="result" rows="25"
                placeholder="Generated text will appear here‚Ä¶"></textarea>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>